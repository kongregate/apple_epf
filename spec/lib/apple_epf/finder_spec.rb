# encoding: UTF-8
require File.expand_path('../../../spec_helper', __FILE__)

describe AppleEpf::Finder do
  describe '.detect_closest_weeks_for_date' do
    it 'should return closest weeks to perform further lookup' do
      all_weeks = %w(20120111 20120118 20120215 20120314 20120321 20120328 20120404 20120509 20120523 20120606 20120620 20120718 20120725 20120801 20120808 20120829 20120919 20120926 20121003 20121017 20121114 20121121 20121128 20130109 20130123 20130130 20130213 20130227 20130320 20130327 20130522 20130529 20130724 20130821 20130925 20131002 20131009 20131016 20131023 20131030 20131106 20131113 20131120 20131127 20131204 20131211 20131218 20131225 20140101 20140108 20140115 20140122 20140129 20140213 20140219 20140226 20140305 20140312 20140319)

      interesting_date = Date.parse('20140124')

      r = AppleEpf::Finder.detect_closest_weeks_for_date(all_weeks, interesting_date)
      r.should == %w(20140108 20140115 20140122 20140129)

      interesting_date = Date.parse('20131002')

      r = AppleEpf::Finder.detect_closest_weeks_for_date(all_weeks, interesting_date)
      r.should == %w(20130925 20131002 20131009 20131016)
    end
  end
end
